{% extends 'base.html' %}
{% load static %}


{% block title %}
Vision Result
{% endblock %}

{% block style %}
<link rel="stylesheet" href="{% static 'website/css/form-loader.css' %}">
{% endblock %}


{% block content %}

<div class="container mt-4">
    <div class="form-container">
        {% if refresh_button %}
            <div class="text-center">
                <form action="{% url 'website:get_results' job_id %}" id="myForm">
                    {% csrf_token %}
                    <h4 id="myTitle" class="mb-4" style="color: #E2E2E2;">{{ api_response }}</h4>

                    <button class="btn btn-light btn-lg rounded-3" id="submitBtn" onclick="showLoadingScreen()" type="submit">Check Process</button>
                </form>
            </div>

            <!--Loader-->
            <div class="text-center mt-4">
                <div id="loading-container" style="display: none;">
                    <div id="spinner-container">
                        <div class="dot-spinner">
                            <div class="dot-spinner__dot"></div>
                            <div class="dot-spinner__dot"></div>
                            <div class="dot-spinner__dot"></div>
                            <div class="dot-spinner__dot"></div>
                            <div class="dot-spinner__dot"></div>
                            <div class="dot-spinner__dot"></div>
                            <div class="dot-spinner__dot"></div>
                            <div class="dot-spinner__dot"></div>
                        </div>
                    </div>
                </div>
            </div>
        {% else %}
            <h4 class="text-center mb-4" style="color: #E2E2E2;">Your Narration</h4>
            <div id="text-container"></div>
            <div class="text-center mt-4">
                <a class="btn btn-light btn-lg rounded-3" href="{% url 'users:profile:user_profile' user.id %}">Your Projects</a>
            </div>
        {% endif %}
    </div>
</div>

{% endblock %}

{% block script %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
    const text = "{{ api_response|safe }}";
    let i = 0;
    const container = document.getElementById('text-container');

    function displayLetter() {
        if (i < text.length) {
            container.innerHTML += text.charAt(i); // Add the next letter
            i++;
            setTimeout(displayLetter, 20 + Math.random() * 40); // Randomize time
        }
    }

    displayLetter(); // Start the animation
});
</script>

<script type="text/javascript" src="{% static 'website/js/form-loader-custom.js' %}"></script>
{% endblock %}
